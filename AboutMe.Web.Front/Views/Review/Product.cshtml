@model AboutMe.Web.Front.Models.ReviewProductListViewModel
@using AboutMe.Common.Helper
@using AboutMe.Web.Front.Controllers
@{
    ViewBag.Title = "Review Product";
    Layout = "~/Views/Shared/_AboutMeLayoutA.cshtml";
    var myController = ViewContext.Controller as ReviewController;
}
@section Head{
    @{ Html.RenderPartial("~/Views/AboutMePartial/_Head.cshtml");}
    <script src="/aboutCom/js/lib/masonry.pkgd.min.js" type="text/javascript"></script>
    <script src="/aboutCom/js/lib/imagesloaded.pkgd.min.js" type="text/javascript"></script>
    <link href="/aboutCom/css/review.css" rel="stylesheet" />

    <script>

        var categoryCode = "@Model.DefaultCategoryCode";
        var sort = "@Model.DefaultSort";//포토순
        var tailIdx;

        function selectCategoryMenu(cc) {
            categoryCode = cc;

            getReviewProducList();
        }

        function sorting(s) {
            sort = s;

            getReviewProducList();
        }

        function moremore() {
            getReviewProducList();
        }


    </script>


<script type="text/javascript">
    //<![CDATA[
    $(function () {

        //example  http://masonry.desandro.com/methods.html#appended
        var $msnryContainer = $("#reviewConts");
        $msnryContainer.imagesLoaded(function () {
            $msnryContainer.masonry({
                transitionDuration: 0,
                itemSelector: '.grid'
            });
        })

    });


    function getReviewProducList() {
        $.ajax({
            url: "@(Url.Action("GetReviewProductList", "Review"))",
            type: "POST",
            dataType: "json",
            data: {
                TAIL_IDX: tailIdx
                ,CATEGORY_CODE:categoryCode
                ,SORT:sort
            },
            success: function (data) {
                //alert(data.success);
                console.log(data);
            },
            error: function (e) {
                console.log(e);
            }
        });
    }
    //]]>
</script>

}

@section Body{
    <div class="wrap review">
        <!--header-->
        @{ Html.RenderPartial("~/Views/AboutMePartial/_Header.cshtml");}
        <!--//header-->
        <!--container-->
        <div id="container">
            <div class="container1080">
                <div class="h_tit">
                    <h2 class="cnt">상품 리뷰</h2>
                    <h2><a href="/Review/Experience">체험단 리뷰</a></h2>
                </div>

                <div class="selecttypeC">
                    <!--현재 소팅 대분류 class "on" 사용-->
                    <div class="sort">
                        <p class="tit"><a href="#">뷰티</a></p>

                        @if (Model.CategoryBeauty.Count > 0)
                        {
                            <ul>
                                <li><a href="#" onclick="selectCategoryMenu('101100100'); return false;">전체</a></li>
                                @foreach (var item in Model.CategoryBeauty)
                                {

                                     <li><a href="#" onclick="selectCategoryMenu('@item.CATE_CODE'); return false;">@item.DEPTH2_NAME</a></li>
                                }
                            </ul>
                        }

                    </div>
                    <div class="sort ">
                        <p class="tit">헬스</p>
                        <ul>
                            <li><a href="#" onclick="selectCategoryMenu('102100100'); return false;">전체</a></li>
                        </ul>
                    </div>
                    <div class="sort">
                        <p class="tit">셀렉샵</p>
                        @if (Model.CategorySelShop.Count > 0)
                        {
                            <ul>
                                <li><a href="#" onclick="selectCategoryMenu('103100100'); return false;">전체</a></li>
                                @foreach (var item in Model.CategorySelShop)
                                {
                                    <li><a href="#" onclick="selectCategoryMenu('@item.CATE_CODE');return false;">@item.DEPTH2_NAME</a></li>
                                }
                            </ul>
                        }
                    </div>
                    <div class="sort">
                        <p class="tit">테마별</p>
                        <ul>
                            <li><a href="#">테마1</a></li>
                            <li><a href="#">테마2</a></li>
                        </ul>
                    </div>
                </div>

                <div class="reviewConts_area">
                    <span class="totaltxt">총 <strong>100</strong>개의 상품이 있습니다.</span>
                    <!--sort-->
                    <div class="sort">
                        <ul>
                            <li class="cnt"><a href="#" onclick="sorting('0');return false;">포토리뷰순</a></li>
                            <li><a href="#" onclick="sorting('1');return false;">최신순</a></li>
                        </ul>
                    </div>
                    <!--//sort-->
                    <div id="reviewConts" class="bocksitls">
                      @foreach (var item in Model.Products)
                      {
                        <div class="grid">
                            <!--
                                best 선정시 class="best_choice" 추가됩니다.
                            -->
                            @if ( !String.IsNullOrEmpty( item.PRIZE_GRADE )  )
                            {
                                <span class="@ReviewHelper.isBest(item.PRIZE_GRADE)"><img src="/aboutCom/images/review/ico_best.png" alt="best"></span>
                            }
                            
                            <!--제품 이름 및 정보-->
                            <div class="product_info">
                                <div class="photo"><img src="@myController._img_path_product@item.P_MAIN_IMG" alt=""></div>
                                <div class="detail">
                                    <p class="tit">@item.P_NAME</p>
                                    <p class="stit">@item.P_SUB_TITLE</p>
                 
                                </div>
                            </div>
                            <!--//제품 이름 및 정보-->
                            <!--리뷰-->
                            <div class="comments">
                                <div class="writer">
                                    <span class="id">@item.M_ID</span>
                                    <span class="userage">@ReviewHelper.ConvertAge( @item.M_BIRTHDAY), @ReviewHelper.ConvertGenger( @item.M_SEX)</span>
                                    <!--
                                        피부타입 css
                                        건성 : dry
                                        중성 : normal
                                        지성 : oily
                                    -->
                                    <span class="skin @ReviewHelper.ConvertSkinType( @item.SKIN_TYPE)"></span>
                                </div>
                                <div class="reviewtxt">
                                    <img src="@myController._img_path_review@item.ADD_IMAGE" alt="">
                                    <div class="txt txtdotdot">
                                        @item.COMMENT
                                    </div>
                                </div>
                            </div>
                            <!--//리뷰-->
                        </div>
                      }
                    </div>
                </div>


                <a href="#" class="btn_more" onclick="moremore(); return false;">더보기<i></i></a>


            </div>
        </div>
        <!--//container-->
        <!--Footer-->
        @{ Html.RenderPartial("~/Views/AboutMePartial/_Footer.cshtml");}
        <!--//Footer-->

    </div>
    <!--//wrap-->
}

